<!-- Wklej jako blok Własny HTML w WordPress – strona cennika Imprezja Quiz -->
<!-- Wymaga: stripe-shop uruchomiony na serwerze, API dostępne pod STRIPE_API_URL -->
<div class="imprezja-cennik" style="max-width: 900px; margin: 0 auto; padding: 20px;">
    <h2 style="text-align: center; margin-bottom: 40px;">Wybierz plan Imprezja Quiz</h2>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
        <div style="background: #f8f9fa; border-radius: 12px; padding: 24px; text-align: center; border: 2px solid #dee2e6;">
            <h3 style="color: #333; margin-bottom: 8px;">1 miesiąc</h3>
            <p style="font-size: 1.5rem; font-weight: bold; color: #0073aa;">30 PLN</p>
            <p style="color: #666; font-size: 0.9rem; margin-bottom: 16px;">subskrypcja miesięczna</p>
            <button onclick="imprezjaCheckout('imprezja-1m', this)" style="width: 100%; padding: 12px; background: #0073aa; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">Wybierz</button>
        </div>

        <div style="background: #fff8e1; border-radius: 12px; padding: 24px; text-align: center; border: 2px solid #f1c40f;">
            <span style="background: #f1c40f; color: #000; font-size: 11px; padding: 4px 10px; border-radius: 20px;">Popularny</span>
            <h3 style="color: #333; margin: 8px 0;">3 miesiące</h3>
            <p style="font-size: 1.5rem; font-weight: bold; color: #0073aa;">80 PLN</p>
            <p style="color: #666; font-size: 0.9rem; margin-bottom: 16px;">oszczędność ~15%</p>
            <button onclick="imprezjaCheckout('imprezja-3m', this)" style="width: 100%; padding: 12px; background: #0073aa; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">Wybierz</button>
        </div>

        <div style="background: #f8f9fa; border-radius: 12px; padding: 24px; text-align: center; border: 2px solid #dee2e6;">
            <h3 style="color: #333; margin-bottom: 8px;">12 miesięcy</h3>
            <p style="font-size: 1.5rem; font-weight: bold; color: #0073aa;">290 PLN</p>
            <p style="color: #666; font-size: 0.9rem; margin-bottom: 16px;">najlepsza wartość</p>
            <button onclick="imprezjaCheckout('imprezja-12m', this)" style="width: 100%; padding: 12px; background: #0073aa; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">Wybierz</button>
        </div>

        <div style="background: #e8f5e9; border-radius: 12px; padding: 24px; text-align: center; border: 2px solid #27ae60;">
            <h3 style="color: #333; margin-bottom: 8px;">Dożywotnia</h3>
            <p style="font-size: 1.5rem; font-weight: bold; color: #27ae60;">500 PLN</p>
            <p style="color: #666; font-size: 0.9rem; margin-bottom: 16px;">jednorazowa płatność</p>
            <button onclick="imprezjaCheckout('imprezja-lifetime', this)" style="width: 100%; padding: 12px; background: #27ae60; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">Kup</button>
        </div>
    </div>

    <p id="imprezja-error" style="color: #c0392b; margin-top: 20px; display: none;"></p>
</div>

<script>
(function() {
    // URL stripe-shop na Render
    const STRIPE_API_URL = 'https://imprezja-quiz-1-0-2-beta.onrender.com';

    window.imprezjaCheckout = async function(lookupKey, btn) {
        btn.disabled = true;
        document.getElementById('imprezja-error').style.display = 'none';

        try {
            const res = await fetch(STRIPE_API_URL + '/create-checkout-session', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    lookup_key: lookupKey,
                    success_url: window.location.origin + '/sukces/?session_id={CHECKOUT_SESSION_ID}',
                    cancel_url: window.location.href
                })
            });
            const data = await res.json();
            if (data.url) {
                window.location.href = data.url;
            } else {
                throw new Error(data.error || 'Błąd serwera');
            }
        } catch (err) {
            document.getElementById('imprezja-error').textContent = err.message || 'Błąd połączenia';
            document.getElementById('imprezja-error').style.display = 'block';
            btn.disabled = false;
        }
    };
})();
</script>
